---
layout: post
title:  "RU | 'Command & Control - level 2' from root-me.org"
date:   2023-09-18 15:20:02 +0300
categories: forensic
---
![First](/assets/cmd1_0.jpg)

<h4>Сегодня хочу разобрать интересное задание, и выглядит оно вот так:</h4>

><h4>Поздравляем Бертье, благодаря вашей помощи компьютер был идентифицирован. Вы запросили дамп памяти, но перед началом анализа хотели посмотреть на логи антивируса. К сожалению, вы забыли записать имя хоста рабочей станции. Но раз у вас есть дамп памяти, то вы сможете его восстановить! Флаг проверки - это имя хоста рабочей станции.</h4>

<h4>Главное обратить внимание на то, что от нас требуют, ибо нам нужно найти именно имя хоста, а не имя пользователя.</h4>  
<h4>Для этой задачи нам понадобится инструмент volatility. Распаковываем архив, открываем cmd и первым нашим шагом будет получение информации о дампе, а точнее о его профиле(тип системы). Если обратиться к официальной документации, то при анализе дампа нужно учесть следующее:</h4>

><h4>Volatility необходимо знать, из какой системы получен дамп памяти, чтобы знать, какие структуры данных, алгоритмы и символы использовать.</h4>

<h4>Открываем cmd и пишем:</h4>

><h4>volatility -f "путь/имя дампа" imageinfo</h4>
![Second](/assets/cmd1_1.jpg)

<h4>Получаем 3 подходящих профиля под этот дамп и выбираем любой. В моем случае это будет Win7SP0x86.</h4>  
<h4>Далее, кратчайший путь до извлечения имени компьютера - это использование команды envars, опять же выдержка из оф. документации:</h4>

><h4>Для отображения переменных окружения процесса используйте плагин envars. Обычно он показывает количество установленных процессоров и аппаратную архитектуру, текущий каталог процесса, временный каталог, имя сессии, имя компьютера, имя пользователя и другие интересные артефакты.</h4>

<h4>Вводим:</h4>

><h4>volatility -f "путь/имя дампа" --profile=Win7SP1x86 envars</h4>

<h4>Чуть пролистываем и ищем переменную с именем COMPUTERNAME:</h4>
![Third](/assets/cmd1_2.jpg)

<h4>+ 15 очков</h4>